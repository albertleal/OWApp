<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<title>test animations</title>
	<link href="../themes/default/bootstrap-3.0.2/css/bootstrap.min.css" rel="stylesheet">
	<link href="../themes/default/css/bootstrapOverride.css" rel="stylesheet">
	<link href="../themes/default/css/default.css" rel="stylesheet">
	<link href="../themes/default/css/animations.css" rel="stylesheet"></head>
<body class="">
	<div id="container">
		<div id="leftLayer" class="canvas off-canvas-left">
			<div class="canvas-content">
				<ul id="menu" class="canvas scrollable">
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 2</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 3</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 4</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 5</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 6</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 7</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 8</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 9</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 10</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 11</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 12</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 13</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 14</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 15</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 16</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 17</div>
					</li>
					<li class="menu-element">
						<div class="icon"></div>
						<div class="content">test 18</div>
					</li>
				</ul>
			</div>
		</div>
		<div id="centerLayer" class="canvas in-canvas">
			<div id="header" class="canvas-content">
				<div id="displayLeftPanel">&nbsp;</div>
				<center>
					<div id="title">operation title</div>
				</center>
			</div>
			<div class="alert alert-dismissable"><button type="button" class="close" aria-hidden="true">&times;</button><span id="alertText"></span></div>
			<div class="scrollable" id="operationContent">
				
			</div>
			<div id="footer">hola footer</div>
		</div>
		<div id="rightLayer" class="canvas off-canvas-right">
			<div class="canvas-content">
				RIGHT
				<a href="javascript:toogleOffCanvasRight();">toogleOffCanvasRight</a>
			</div>
		</div>
	</div>
	<script type="text/javascript" charset="utf-8" src="../js/lib/jquery/jquery-2.0.3.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="../themes/default/bootstrap-3.0.2/js/bootstrap.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="../js/lib/hammer/hammer.js"></script>
	<script type="text/javascript" charset="utf-8" src="../js/lib/hammer/jquery.hammer.js"></script>
	<script type="text/javascript">
		function showLeftMenu(){
			if($('.in-canvas').hasClass('in-canvas-left-active')){
				$('#operationContent').removeClass('no-touch');
				$('#footer').removeClass('no-touch');
				
				$('#operationContent').addClass('scrollable');
				$('#menu').removeClass("scrollable");

				$('.in-canvas').addClass('pushLeftContentForMenu');
				$('.off-canvas-left').addClass('pushLeftMenu');	
				$('#displayLeftPanel').removeClass('ui-state-active');	
				setTimeout(function(){
					$('.in-canvas').removeClass('in-canvas-left-active');
					$('.off-canvas-left').removeClass('off-canvas-left-active');
					$('.in-canvas').removeClass('pushLeftContentForMenu');
					$('.off-canvas-left').removeClass('pushLeftMenu');
				},3000);
			}else{
				$('#menu').scrollTop(0);
				$('#operationContent').addClass('no-touch');
				$('#footer').addClass('no-touch');
				
				$('#operationContent').removeClass('scrollable');
				$('#menu').addClass("scrollable");

				$('.in-canvas').addClass('pushRightContentForMenu');
				$('.off-canvas-left').addClass('pushRightMenu');
				$('#displayLeftPanel').addClass('ui-state-active');
				setTimeout(function(){
					$('.in-canvas').removeClass('pushRightContentForMenu');
					$('.off-canvas-left').removeClass('pushRightMenu');
					$('.in-canvas').addClass('in-canvas-left-active');
					$('.off-canvas-left').addClass('off-canvas-left-active');
				},3000);
			}
		}
		$(document).ready(function() {
			//No scrollable webapp
			window.ontouchmove = function(e) {e.preventDefault()};
			//Force scroll on scrollable class
			$('.scrollable').on('touchmove', function(e){
				//alert('scroll');
				e.stopImmediatePropagation();
			});
			$( window ).resize(function() {
				resizeInterface();
			});
			window.addEventListener("orientationchange", function() {
				resizeInterface();
			}, false);
			resizeInterface();
			$('#displayLeftPanel').on('click',function(){
				showLeftMenu();
			});
			$('#title').on('click',function(){
				if(!$('#operationContent').hasClass('no-touch')){
					$('#operationContent').animate({
					  scrollTop: 0
					}, 300);
				}
			});
			$('#header').on('click',function(){
				if($('#operationContent').hasClass('no-touch')){
					showLeftMenu();
				}
			});
			$('body').hammer().on('swipe', function(event){ //capture swipe event
				if ( $('#leftLayer').hasClass('off-canvas-left-active') ) { //active menu
					if (event.gesture.direction == 'left') { //swipe left
						//alert('LEFT!');
						showLeftMenu();
					}					
				}else{
					var tanto = ($('#centerLayer').width()*30)/100; //30% container width(left menu size)
					if (event.gesture.startEvent.center.pageX < tanto) { //did gesture start in
						if (event.gesture.direction == 'right') { //swipe right
							//alert('RIGHT!');
							showLeftMenu();
						}
					}else{ //out of menu zone
						//alert('TOO FAR FROM MENU!');
					}
				}
			});
			$('#operationContent').scroll(function() {
  				$('.alert').hide();
			});
			$('button.close').on('click', function(e){
				e.preventDefault();
				$('.alert').hide();
			});
			//fake navigation 
			loadView('first-view');
		});

		function resizeInterface(){
			var windowWidth = $( window ).width();
			var windowHeight = $( window ).height();
			var headerHeight = $('#header').height();	
			var footerHeight = $('#footer').is(":visible") ? $('#footer').height() : 0;		

			if(windowWidth > 320){
				$('body').removeClass("mobile");
				$('body').addClass("tablet");
			}else{
				$('body').removeClass("tablet");
				$('body').addClass("mobile");
			}
			$('.canvas').height(windowHeight);
			$('#menu').height(windowHeight-parseInt($('.canvas-content').css('padding-top').replace('px','')));
			$('#operationContent').height(windowHeight-headerHeight-footerHeight);
		};

		function loadView(view){
			$.ajax({
			  url: view+".html",
			  cache: false
			}).done(function( html ) {
				$('#operationContent').html('');
			    $('#operationContent').append( html );
			}).fail(function() {
    			$('#alertText').html('Error cargando la p√°gina');
    			$('.alert').addClass('alert-danger');
    			$('.alert').show();
  			});
		}
	</script>
</body>
</html>